System.register(["./index-legacy.6d6ccd4d.js"],(function(e,t){"use strict";var o,a,n,r,i,d,l,s,u,c,m,b,p,g,h,f,x,y,v,w=document.createElement("style");return w.textContent='.message[data-v-978172a3]{float:left;margin-bottom:.5rem;box-sizing:border-box;display:block;width:auto;height:auto;white-space:pre-wrap;border-width:2px;--un-border-opacity:1;border-color:rgba(229,231,235,var(--un-border-opacity));border-radius:.5rem;border-style:solid;padding:.5rem;line-height:1.5em}.clearfix[data-v-978172a3]{content:" ";display:table;clear:both}.button[data-v-978172a3]{margin-left:.5rem;width:5em;border-width:1px;--un-border-opacity:1;border-color:rgba(209,213,219,var(--un-border-opacity));border-radius:.25rem;--un-bg-opacity:1;background-color:rgba(96,165,250,var(--un-bg-opacity));background-image:none;font-weight:700;--un-text-opacity:1;color:rgba(255,255,255,var(--un-text-opacity));outline:2px solid transparent;outline-offset:2px}.list-item[data-v-c61c8707]{box-sizing:border-box;width:100%;display:flex;cursor:pointer;align-items:center;justify-content:flex-start;border-radius:.5rem;padding-left:.5rem}\n',document.head.appendChild(w),{setters:[e=>{o=e.d,a=e.u,n=e.r,r=e.c,i=e.o,d=e.a,l=e.b,s=e.F,u=e.e,c=e.f,m=e.w,b=e.v,p=e.t,g=e.p,h=e.g,f=e._,x=e.h,y=e.i,v=e.n}],execute:function(){var t=(e=>(e[e.Ok=200]="Ok",e[e.BadRequest=400]="BadRequest",e[e.InteralServerError=500]="InteralServerError",e))(t||{});const w={flex:"","flex-col":"","flex-1":"","p-1":"","pl-0":""},k={class:"flex-1 w-full m-auto p-4 rounded-lg box-border"},C={key:0,class:"message"},_={key:1,class:"message !float-right"},T=(e=>(g("data-v-978172a3"),e=e(),h(),e))((()=>l("div",{class:"clearfix"},null,-1))),B={class:"mt-4"},E={class:"flex w-full h-4em px-4 my-4 box-border"},I=f(o({__name:"ChatView",setup(e){const o=a(),g=n({editContent:"",editing:!1}),h=r((()=>o.current.messages)),f=async e=>{if(null==e||e.preventDefault(),g.editing)return;if(!g.editContent)return void window.alert("请输入信息");o.current.messages.push({sentBy:"human",content:g.editContent}),g.editContent="";const{uuid:a}=o.current;try{const e=await window.fetch("/api/chat",{body:JSON.stringify({prompt:h.value[h.value.length-1].content,conversation_id:a}),headers:{"Content-Type":"application/json"},method:"POST"});let n;switch(e.status){case t.Ok:e.json().then((e=>{o.rooms[a].messages.push({sentBy:"chat-gpt",content:e.ai_text})}));break;case t.BadRequest:n="请求参数错误";break;case t.InteralServerError:n="服务器错误";break;default:n="未知错误"}if(void 0!==n)throw new Error(`${n}，请重新发送消息`)}catch(n){window.alert(n.message)}},x=()=>{window.fetch("/api/reset").then((()=>{o.resetChatroom(o.current.uuid),console.log(o.current)}))};return(e,t)=>(i(),d("div",w,[l("div",k,[(i(!0),d(s,null,u(c(h),((e,t)=>(i(),d(s,{key:t},["chat-gpt"===e.sentBy?(i(),d("div",C,p(e.content),1)):(i(),d("div",_,p(e.content),1)),T],64)))),128))]),l("div",B,[l("div",E,[m(l("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.editContent=e),contenteditable:"",class:"flex-1 p-2 b-gray-300 b-solid b-2 rounded-lg",onCompositionstart:t[1]||(t[1]=()=>g.editing=!0),onCompositionend:t[2]||(t[2]=()=>g.editing=!1)},null,544),[[b,g.editContent]]),l("button",{class:"button",onClick:f}," Submit "),l("button",{class:"button",onClick:x}," Clear ")])])]))}}),[["__scopeId","data-v-978172a3"]]),S=["xlink:href"],O=o({__name:"BaseIcon",props:{fileUrl:{default:"icons.svg"},id:null},setup(e){const t=e,o=r((()=>`${t.fileUrl}#${t.id}`));return(e,t)=>(i(),d("svg",null,[l("use",{"xlink:href":c(o)},null,8,S)]))}}),j={"w-50":"","p-1":"","box-border":"","leading-3em":"","text-left":"",bg:"gray-7",text:"white"},L=(e=>(g("data-v-c61c8707"),e=e(),h(),e))((()=>l("span",{"ml-2":""},"New Chat",-1))),U=["onKeydown"],V=["data-chatroom-uuid"],$=["onUpdate:modelValue","data-chatroom-uuid","onBlur"],q=["data-chatroom-uuid"],H=f(o({__name:"ChatroomList",setup(e){const t=e=>e.getAttribute("data-chatroom-uuid"),o=a(),n=e=>{if(e.target instanceof HTMLLIElement){const a=t(e.target);a&&(o.current=o.rooms[a])}},r=e=>{if(e.target instanceof HTMLElement){const a=t(e.target);if(a){const e=o.rooms[a];e&&(e.editTitle=!0)}}},g=e=>{if(e.target instanceof HTMLElement){const a=t(e.target);if(a){const e=o.rooms[a];e&&e.editTitle&&(e.editTitle=!1)}}};return(e,t)=>(i(),d("div",j,[l("div",{b:"1 solid gray-4 rounded-lg",class:"list-item",onClick:t[0]||(t[0]=e=>c(o).addChatroom(`Playground ${Object.keys(c(o).rooms).length+1}`))},[x(c(O),{id:"add","w-1.8em":"","h-1.8em":""}),L]),l("ul",{"list-none":"","p-0":"","w-full":"","box-border":"",onClick:n,onDblclick:r,onKeydown:y(g,["enter"])},[(i(!0),d(s,null,u(c(o).rooms,(e=>(i(),d("li",{key:e.uuid,"data-chatroom-uuid":e.uuid,class:v(["list-item leading-0 py-5 !px-3 mb-2",{"bg-dark-500/40":c(o).current.uuid===e.uuid}]),hover:"bg-dark-500/40"},[x(c(O),{id:"chat","w-1.5em":"","h-1.5em":"","min-w-1.5em":"","data-chatroom-uuid":e.uuid},null,8,["data-chatroom-uuid"]),e.editTitle?m((i(),d("input",{key:0,"onUpdate:modelValue":t=>e.title=t,"inline-block":"","flex-1":"","w-30":"","ml-2":"",type:"text","data-chatroom-uuid":e.uuid,onBlur:t=>(e=>{const t=o.rooms[e];""===t.title&&(t.title="No name"),t.editTitle=!1})(e.uuid)},null,40,$)),[[b,e.title]]):(i(),d("span",{key:1,"inline-block":"","flex-1":"","ml-3":"","data-chatroom-uuid":e.uuid},p(e.title),9,q))],10,V)))),128))],40,U)]))}}),[["__scopeId","data-v-c61c8707"]]),M={class:"text-dark-300 flex w-100vw h-100vh box-border"};e("default",o({__name:"index",setup:e=>(e,t)=>(i(),d("div",M,[x(H),x(I)]))}))}}}));
